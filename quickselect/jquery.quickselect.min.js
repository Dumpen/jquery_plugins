function object(d){var s=function(){};s.prototype=d;return new s();}(function($){var d=function(f,g){f=$(f);var self=this;var h={indexed:{}};var j=true;var k=-1;var l=false;var m;var n;var o;var p=false;if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var r=Number(RegExp.$1);if(r<=7){p=true;}}var t=$('<div class="'+g.resultsClass+'" style="display:block;position:absolute"></div>').hide();var u=$('<iframe />');u.css({border:'none',position:'absolute'});if(g.width>0){t.css("width",g.width);u.css("width",g.width);}$('body').append(t);if(p){$('body').append(u);}var v=function(H){return H.label||(typeof(H)==='string'?H:H[0])||'';};var w=function(H){return H.values||(H.value?[H.value]:(typeof(H)==='string'?[H]:H))||[];};var x={quicksilver:function(q,H){q=q.toLowerCase();h.indexed[q]=[];for(var i=0;i<H.length;i++){var I=v(H[i]).toLowerCase();if(I.score(q)>0){h.indexed[q].push(H[i]);}}return h.indexed[q].sort(function(a,b){a=v(a);b=v(b);var J=a.toLowerCase().score(q);var K=b.toLowerCase().score(q);return(J>K?-1:(K>J?1:0));});},contains:function(q,H){q=q.toLowerCase();h.indexed[q]=[];for(var i=0;i<H.length;i++){var I=v(H[i]).toLowerCase();if(I.indexOf(q)>-1){h.indexed[q].push(H[i]);}}return h.indexed[q].sort(function(a,b){a=v(a).toLowerCase();b=v(b).toLowerCase();return(a.indexOf(q)>b.indexOf(q)?-1:(a.indexOf(q)<b.indexOf(q)?1:(a>b?-1:(b>a?1:0))));});},startsWith:function(q,H){q=q.toLowerCase();h.indexed[q]=[];for(var i=0;i<H.length;i++){var I=v(H[i]).toLowerCase();if(I.indexOf(q)===0){h.indexed[q].push(H[i]);}}return h.indexed[q].sort(function(a,b){a=v(a).toLowerCase();b=v(b).toLowerCase();return(a>b?-1:(b>a?1:0));});}};var y={store:function(q,H){H(g.data);},ajax:function(q,H){var I=g.ajax+"?q="+encodeURI(q);for(var i in g.ajaxParams){if(g.ajaxParams.hasOwnProperty(i)){I+="\x26"+i+"\x3d"+encodeURI(g.ajaxParams[i]);}}$.getJSON(I,H);}};var z=function(H){var I=$('li',t);if(!I){return;}if(typeof(H)==="number"){k=k+H;}else{k=I.index(H);}if(k<0){k=0;}else{if(k>=I.size()){k=I.size()-1;}}I.removeClass(g.selectedClass);$(I[k]).addClass(g.selectedClass);if(g.autoFill&&this.last_keyCode!=8){f.val(n+$(I[k]).text().substring(n.length));var J=n.length;var K=f.val().length;var L=f.get(0);if(L.createTextRange){var M=L.createTextRange();M.collapse(true);M.moveStart("character",J);M.moveEnd("character",K);M.select();}else if(L.setSelectionRange){L.setSelectionRange(J,K);}else if(L.selectionStart){L.selectionStart=J;L.selectionEnd=K;}L.focus();}};var A=function(){if(o){clearTimeout(o);}f.removeClass(g.loadingClass);if(t.is(":visible")){t.hide();}if(u.is(":visible")){u.hide();}};var B=function(H,I){if(!H){H=document.createElement("li");H.item='';}var J=v(H.item);f.lastSelected=J;f.val(J);n=J;t.empty();var K=w(H.item);g.additional_fields.each(function(i,L){L.value=K[i+1];});if(!I){A();}if(g.onItemSelect){setTimeout(function(){g.onItemSelect(H);},1);}return true;};var C=function(){var H=$("li."+g.selectedClass,t).get(0);if(H){return B(H);}else{if(g.exactMatch){f.val('');g.additional_fields.each(function(i,I){$(I).val('');});}return false;}};var D=function(H){t.empty();var I=document.createElement("ul");t.append(I);if(!l||H===null||H.length===0){return A();}var J=H.length;if(g.maxVisibleItems>0&&g.maxVisibleItems<J){J=g.maxVisibleItems;}var K=function(){z(this);};var L=function(){};var M=function(e){e.preventDefault();e.stopPropagation();B(this);};for(var i=0;i<J;i++){var N=H[i];var O=document.createElement("li");t.append(O);$(O).text(g.formatItem?g.formatItem(N,i,J):v(N));O.item=N;if(N.className){O.className=N.className;}I.appendChild(O);$(O).hover(K,L).click(M);}f.removeClass(g.loadingClass);};var E=function(q,H){y[!g.data?'ajax':'store'](q,function(I){D(x[g.matchMethod](q,I));H();});};var F=function(){var H=f.offset();var I=(g.width>0)?g.width:f.width();t.css({width:parseInt(I,10)+"px",top:H.top+f.height()+5+"px",left:H.left+"px"});if(p){u.css({width:parseInt(I,10)-2+"px",top:H.top+f.height()+6+"px",left:H.left+1+"px",height:t.height()-2+'px'}).show();}t.show();var J=$('li',t);if(g.autoSelectFirst||(g.selectSingleMatch&&J.length==1)){z(J.get(0));}};var G=function(){if(m>=9&&m<=45){return;}var q=f.val();if(q==n){return;}n=q;if(q.length>=g.minChars){f.addClass(g.loadingClass);E(q,F);}else{if(q.length===0&&(g.onBlank?g.onBlank():true)){g.additional_fields.each(function(i,H){H.value='';});}f.removeClass(g.loadingClass);t.hide();u.hide();}};t.mousedown(function(e){j=e.srcElement.tagName!='DIV';});f.keydown(function(e){m=e.keyCode;switch(e.keyCode){case 38:e.preventDefault();z(-1);break;case 40:e.preventDefault();if(!t.is(":visible")){F();z(0);}else{z(1);}break;case 13:if(C()){e.preventDefault();f.select();}break;case 9:C();break;case 27:if(k>-1&&g.exactMatch&&f.val()!=$('li',t).get(k).text()){k=-1;}$('li',t).removeClass(g.selectedClass);A();e.preventDefault();break;default:if(o){clearTimeout(o);}o=setTimeout(G,g.delay);break;}}).focus(function(){l=true;}).blur(function(e){if(j){if(k>-1){C();}l=false;if(o){clearTimeout(o);}o=setTimeout(function(){A();if(g.exactMatch&&f.val()!=f.lastSelected){B(null,true);}},200);}else{e.srcElement.focus();}});};$.fn.quickselect=function(f,g){f=f||{};f.data=(typeof(f.data)==="object"&&f.data.constructor==Array)?f.data:undefined;f.ajaxParams=f.ajaxParams||{};f.delay=f.delay||400;f.minChars=f.minChars||1;f.cssFlavor=f.cssFlavor||'quickselect';f.inputClass=f.inputClass||f.cssFlavor+"_input";f.loadingClass=f.loadingClass||f.cssFlavor+"_loading";f.resultsClass=f.resultsClass||f.cssFlavor+"_results";f.selectedClass=f.selectedClass||f.cssFlavor+"_selected";f.matchMethod=f.matchMethod||((typeof''.score==='function')&&'\x6c'.score('\x6c')==1?'quicksilver':'contains');if(f.matchCase===undefined){f.matchCase=false;}if(f.exactMatch===undefined){f.exactMatch=false;}if(f.autoSelectFirst===undefined){f.autoSelectFirst=true;}if(f.selectSingleMatch===undefined){f.selectSingleMatch=true;}if(f.additional_fields===undefined){f.additional_fields=$('nothing');}f.maxVisibleItems=f.maxVisibleItems||-1;if(f.autoFill===undefined||f.matchMethod!='startsWith'){f.autoFill=false;}f.width=parseInt(f.width,10)||0;this.each(function(){var h=this;var j=object(f);if(h.tagName=='INPUT'){d(h,j);}else if(h.tagName=='SELECT'){j.delay=j.delay||10;var name=h.name;var k=h.id;var l=h.className;var m=$(h).attr('accesskey');var n=$(h).attr('tabindex');var o=$("option:selected",h).get(0);j.data=[];$('option',h).each(function(i,t){j.data.push({label:$(t).text(),values:[t.value,t.value],className:t.className});});var p=$("<input type='text' class='"+l+"' id='"+k+"_quickselect' autocomplete='off' accesskey='"+m+"' tabindex='"+n+"' />");if(o){p.val($(o).text());}var r=$("<input type='hidden' id='"+k+"' name='"+h.name+"' />");if(o){r.val(o.value);}j.additional_fields=r;$(h).after(p).after(r).remove();p.quickselect(j);}});};})(jQuery);